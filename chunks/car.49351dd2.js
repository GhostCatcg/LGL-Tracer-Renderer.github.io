import{L as P,l as I,O as A,i as R,b as k,u as q,D as E,R as x,G as j}from"./stats.module.6802f85e.js";import{A as H,S as z,P as O,at as U,C as W,F as $}from"./vendor.f1de933b.js";import{e as B,g as K}from"./assets.d9fd3e26.js";import{m as J}from"./makeCommonGUI.95201cda.js";const N=[],Q=B.Konzerthaus,V=K.Car;let b=null,r=!1;const o=document.querySelector("#container"),w=document.querySelector(".loadingText"),n=new P;n.bounces=3;n.renderWhenOffFocus=!0;n.toneMapping=H;n.envMapIntensity=2;document.body.appendChild(n.domElement);const h=!0;let y=!1;const{initStats:X,initGUI:Y,initCameraDebugInfo:Z}=J();n.loadingCallback={onProgress:e=>{console.log(e)},onComplete:e=>{w.innerText=e,l(!1),y||(Y(h,n),ee()),y=!0,console.log(e)}};const u=X(h),v=Z(h);let S=null,f=null;const i=new z;I(N,i);const s=new O(45,window.innerWidth/window.innerHeight,.001,1e3),p=new A(s,n.domElement);p.screenSpacePanning=!0;function T(e){b&&i.remove(b);const t=e.scene;te(t),i.add(t),b=t,q(s,p,i)}function C(e){i.environment=e}function _(){const e=document.querySelector("#bubble");localStorage.getItem("bubble")||(e.style.display="block",document.querySelector("#bubble-close").onclick=()=>{e.style.display="none",localStorage.setItem("bubble",!0)})}function M(e){const t=document.querySelector("#bubble");t.style.display="block",document.querySelector(".bubble-text").innerText=e,document.querySelector("#bubble-close").onclick=()=>{t.style.display="none"}}function L(e){e?o.classList.contains("isDroping")||o.classList.add("isDroping"):o.classList.contains("isDroping")&&o.classList.remove("isDroping")}function l(e){e?o.classList.contains("isLoading")||o.classList.add("isLoading"):o.classList.contains("isLoading")&&o.classList.remove("isLoading")}function ee(){const e=n.domElement;e.addEventListener("dragenter",a=>{L(!0)}),e.addEventListener("dragleave",a=>{L(!1)});const t=new U(e,e);t.on("drop",({files:a})=>{if(L(!1),r){M("previous assets no loading complete!");return}r=!0,w.innerText="Building...",l(!0);const c=Array.from(a);c.find(([g,m])=>m.name.match(/\.(gltf|glb)$/))?R(a).then(g=>{T(g),r=!1,n.needsReload=!0,l(!1)}):c.find(([m,G])=>G.name.match(/\.(hdr)$/))?k(a).then(m=>{C(m),n.updateEnvLight(),n.needsUpdate=!0,r=!1,l(!1)}):(r=!1,l(!1),M("Incorrect resource type(support gltf/glb folder or hdr file)!"))}),t.on("droperror",()=>{console.log("Drop Error")}),_()}function te(e){e.traverse(t=>{t.isMesh&&t.material&&(t.material.isMeshStandardMaterial?t.material=new E().fromStandardMaterial(t.material):t.material=new E)}),e.traverse(t=>{t&&t.name&&(t.name==="wingshild"&&t.children.forEach(a=>{a.material.color=new W(1,1,1),a.material.roughness=0,a.material.metalness=0,a.material.transmission=1}),t.name==="Object001"&&t.children.forEach(a=>{a.material.clearcoat=1}))})}async function ne(){const e=new x().setDataType($),t=await new Promise(d=>{e.load(Q,d)});C(t);const a=new j,c=await new Promise(d=>{a.load(V,d)});T(c),n.buildScene(i,s).then(()=>{F()})}function D(){if(n.domElement.parentElement){const e=n.domElement.parentElement.clientWidth,t=n.domElement.parentElement.clientHeight;n.setSize(e,t),s.aspect=e/t,s.updateProjectionMatrix()}}window.addEventListener("resize",D);D();function F(e){p.update(),s.focus=p.target.distanceTo(s.position),u&&u.begin(),n.render(i,s),u&&u.end(),v&&(f=n.getTotalSamples(),S!=f&&(v.innerText=`Samples: ${f}`,S=f)),requestAnimationFrame(F)}ne();
