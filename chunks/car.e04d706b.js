import{L as F,l as I,O as A,i as R,c as k,u as q,D as E,R as x,G as j,e as H,g as z}from"./stats.module.4a77fa82.js";import{A as O,S as U,P as W,au as $,C as B}from"./vendor.fd21b549.js";import{m as K}from"./makeCommonGUI.f7eef3ea.js";const J=[],N=H.Konzerthaus,Q=z.Car;let b=null,r=!1;const o=document.querySelector("#container"),w=document.querySelector(".loadingText"),n=new F;n.bounces=3;n.renderWhenOffFocus=!0;n.toneMapping=O;n.envMapIntensity=2;document.body.appendChild(n.domElement);const h=!0;let v=!1;const{initStats:V,initGUI:X,initCameraDebugInfo:Y}=K();n.loadingCallback={onProgress:e=>{console.log(e)},onComplete:e=>{w.innerText=e,l(!1),v||(X(h,n),_()),v=!0,console.log(e)}};const u=V(h),y=Y(h);let S=null,f=null;const s=new U;I(J,s);const i=new W(45,window.innerWidth/window.innerHeight,.001,1e3),g=new A(i,n.domElement);g.screenSpacePanning=!0;function C(e){b&&s.remove(b);const t=e.scene;ee(t),s.add(t),b=t,q(i,g,s)}function T(e){s.environment=e}function Z(){const e=document.querySelector("#bubble");localStorage.getItem("bubble")||(e.style.display="block",document.querySelector("#bubble-close").onclick=()=>{e.style.display="none",localStorage.setItem("bubble",!0)})}function M(e){const t=document.querySelector("#bubble");t.style.display="block",document.querySelector(".bubble-text").innerText=e,document.querySelector("#bubble-close").onclick=()=>{t.style.display="none"}}function L(e){e?o.classList.contains("isDroping")||o.classList.add("isDroping"):o.classList.contains("isDroping")&&o.classList.remove("isDroping")}function l(e){e?o.classList.contains("isLoading")||o.classList.add("isLoading"):o.classList.contains("isLoading")&&o.classList.remove("isLoading")}function _(){const e=n.domElement;e.addEventListener("dragenter",a=>{L(!0)}),e.addEventListener("dragleave",a=>{L(!1)});const t=new $(e,e);t.on("drop",({files:a})=>{if(L(!1),r){M("previous assets no loading complete!");return}r=!0,w.innerText="Building...",l(!0);const c=Array.from(a);c.find(([p,m])=>m.name.match(/\.(gltf|glb)$/))?R(a).then(p=>{C(p),r=!1,n.needsReload=!0,l(!1)}):c.find(([m,P])=>P.name.match(/\.(hdr)$/))?k(a).then(m=>{T(m),n.updateEnvLight(),n.needsUpdate=!0,r=!1,l(!1)}):(r=!1,l(!1),M("Incorrect resource type(support gltf/glb folder or hdr file)!"))}),t.on("droperror",()=>{console.log("Drop Error")}),Z()}function ee(e){e.traverse(t=>{t.isMesh&&t.material&&(t.material.isMeshStandardMaterial?t.material=new E().fromStandardMaterial(t.material):t.material=new E)}),e.traverse(t=>{t&&t.name&&(t.name==="wingshild"&&t.children.forEach(a=>{a.material.color=new B(1,1,1),a.material.roughness=0,a.material.metalness=0,a.material.transmission=1}),t.name==="Object001"&&t.children.forEach(a=>{a.material.clearcoat=1}))})}async function te(){const e=new x,t=await new Promise(d=>{e.load(N,d)});T(t);const a=new j,c=await new Promise(d=>{a.load(Q,d)});C(c),n.buildScene(s,i).then(()=>{G()})}function D(){if(n.domElement.parentElement){const e=n.domElement.parentElement.clientWidth,t=n.domElement.parentElement.clientHeight;n.setSize(e,t),i.aspect=e/t,i.updateProjectionMatrix()}}window.addEventListener("resize",D);D();function G(e){g.update(),i.focus=g.target.distanceTo(i.position),u&&u.begin(),n.render(s,i),u&&u.end(),y&&(f=n.getTotalSamples(),S!=f&&(y.innerText=`Samples: ${f}`,S=f)),requestAnimationFrame(G)}te();
